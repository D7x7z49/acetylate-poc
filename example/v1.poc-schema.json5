{
  "$defs": {
    "Assertion": {
      "properties": {
        "condition": {
          "description": "The type of condition to validate, such as \"status_code\" or \"response_body_contains\".",
          "title": "Condition",
          "type": "string"
        },
        "value": {
          "description": "The expected result or condition to check for in the POC's response.",
          "title": "Value",
          "type": "string"
        },
        "message": {
          "default": null,
          "description": "An optional message to display if the assertion fails, providing context or details about the failure.",
          "title": "Message",
          "type": "string"
        }
      },
      "required": [
        "condition",
        "value"
      ],
      "title": "Assertion",
      "type": "object"
    },
    "CTISearchEngineTarget": {
      "properties": {
        "target_type": {
          "description": "The type of target, such as a network space or specific IP address.",
          "enum": [
            "network",
            "CTI SearchEngine"
          ],
          "title": "Target Type",
          "type": "string"
        },
        "engine": {
          "description": "The name of the CTI search engine used to identify the target, such as Shodan or Censys.",
          "title": "Cyber Threat Intelligence (CTI) Search Engine",
          "type": "string"
        },
        "query": {
          "description": "The search query used with the search engine to locate potential targets or services.",
          "title": "Search Query",
          "type": "string"
        }
      },
      "required": [
        "target_type",
        "engine",
        "query"
      ],
      "title": "CTISearchEngineTarget",
      "type": "object"
    },
    "Description": {
      "properties": {
        "title": {
          "description": "A brief title summarizing the content of the description.",
          "title": "Title",
          "type": "string"
        },
        "content": {
          "description": "A detailed narrative explaining the POC, including its purpose, potential impact, and any relevant technical details.",
          "title": "Content",
          "type": "string"
        },
        "references": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional array of references supporting the description, such as links to reports, articles, or other documentation.",
          "title": "References"
        }
      },
      "required": [
        "title",
        "content"
      ],
      "title": "Description",
      "type": "object"
    },
    "HttpPayload": {
      "properties": {
        "payload_type": {
          "const": "http",
          "description": "The type of payload, which determines the format and content of the payload data.",
          "enum": [
            "http"
          ],
          "title": "Payload Type",
          "type": "string"
        },
        "method": {
          "description": "The HTTP method to use for the request.",
          "title": "HTTP Method",
          "type": "string"
        }
      },
      "required": [
        "payload_type",
        "method"
      ],
      "title": "HttpPayload",
      "type": "object"
    },
    "Metadata": {
      "properties": {
        "authors": {
          "description": "An array listing the authors of the POC, providing credit to those who developed or documented it.",
          "items": {
            "type": "string"
          },
          "minItems": 1,
          "title": "Authors",
          "type": "array"
        },
        "descriptions": {
          "description": "An array of descriptive sections providing context and details about the POC. Each description includes a title and content, with optional references.",
          "items": {
            "$ref": "#/$defs/Description"
          },
          "minItems": 1,
          "title": "Descriptions",
          "type": "array"
        },
        "tags": {
          "description": "An array of tags used to categorize and provide searchable attributes for the POC.",
          "items": {
            "type": "string"
          },
          "title": "Tags",
          "type": "array"
        },
        "cve": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional array of CVE identifiers that relate the POC to specific known vulnerabilities.",
          "title": "CVE"
        }
      },
      "required": [
        "authors",
        "descriptions",
        "tags"
      ],
      "title": "Metadata",
      "type": "object"
    },
    "TcpPayload": {
      "properties": {
        "payload_type": {
          "const": "tcp",
          "description": "The type of payload, which determines the format and content of the payload data.",
          "enum": [
            "tcp"
          ],
          "title": "Payload Type",
          "type": "string"
        }
      },
      "required": [
        "payload_type"
      ],
      "title": "TcpPayload",
      "type": "object"
    },
    "UdpPayload": {
      "properties": {
        "payload_type": {
          "const": "udp",
          "description": "The type of payload, which determines the format and content of the payload data.",
          "enum": [
            "udp"
          ],
          "title": "Payload Type",
          "type": "string"
        }
      },
      "required": [
        "payload_type"
      ],
      "title": "UdpPayload",
      "type": "object"
    }
  },
  "properties": {
    "version": {
      "description": "Indicates the version of the POC file format. This helps in managing and validating schema compatibility.",
      "title": "Version",
      "type": "string"
    },
    "metadata": {
      "$ref": "#/$defs/Metadata",
      "description": "Metadata providing additional context about the POC, including authorship, descriptive information, related CVEs, and categorization tags."
    },
    "target": {
      "description": "Specification of the target for the POC. The structure depends on the type of target, such as network-based search engine queries.",
      "discriminator": {
        "mapping": {
          "CTI SearchEngine": "#/$defs/CTISearchEngineTarget",
          "network": "#/$defs/CTISearchEngineTarget"
        },
        "propertyName": "target_type"
      },
      "oneOf": [
        {
          "$ref": "#/$defs/CTISearchEngineTarget"
        }
      ],
      "title": "Target"
    },
    "payload": {
      "description": "The payload used for the POC, which varies based on the protocol and type of data being sent.",
      "discriminator": {
        "mapping": {
          "http": "#/$defs/HttpPayload",
          "tcp": "#/$defs/TcpPayload",
          "udp": "#/$defs/UdpPayload"
        },
        "propertyName": "payload_type"
      },
      "oneOf": [
        {
          "$ref": "#/$defs/TcpPayload"
        },
        {
          "$ref": "#/$defs/UdpPayload"
        },
        {
          "$ref": "#/$defs/HttpPayload"
        }
      ],
      "title": "Payload"
    },
    "assertions": {
      "description": "A list of assertions to validate the POC's expected outcomes. Each assertion includes a condition to check and the expected value.",
      "items": {
        "$ref": "#/$defs/Assertion"
      },
      "minItems": 1,
      "title": "Assertions",
      "type": "array"
    }
  },
  "required": [
    "version",
    "metadata",
    "target",
    "payload",
    "assertions"
  ],
  "title": "PoC Schema",
  "type": "object"
}